<div class="animate-repeat">

  <cardheader ng-if="header" geom="geom"></cardheader>

  <div
    ng-if="showNoData && header"
    class="card active card-content">
    <em translate>No data available for this location</em>
  </div>

  <rain
    ng-if="geom.properties.rain && (geom.id || geom.geometry.type !== 'Polygon')"
    rain="geom"
    time-state="timeState">
  </rain>

  <annotations
    ng-if="header && geom.geometry.type === 'Point'"
    data="geom"
    time-state="timeState">
  </annotations>


  <defaultpoint
    ng-if="geom.geometry.type === 'Point' && !geom.properties.rain "
    ng-repeat="(slug, content) in geom.properties"
    content="content"
    name="slug"
    state="omnibox.state">
  </defaultpoint>

  <div
    ng-if="geom.geometry.type === 'LineString'"
    class="card active card-content"
    ng-repeat="(slug, content) in geom.properties">
    <graph ng-if="content.scale === 'interval' || content.scale === 'ratio'"
      line
      data="content.data"
      ylabel="content.quantity + ' [' + content.unit + ']'"
      xlabel="'Afstand in [m]'">
    </graph>
    <!--    TODO: get proper response from the server when requesting a line of
    nominal dat and decomment this line
    <graph ng-if="l.scale === 'nominal'"
      horizontal-stack
      data="l.data"
      keys="{x: 'data', y: 'label'}"
      xlabel="'[%]'"
      dimensions="{height: 80, padding: {left: 0, right: 0, top: 5, bottom: 50}}">
    </graph> -->

    <div class="card-tools">
       <a
         class="btn btn-default btn-xs"
         title="<% 'Export info card data' | translate %>"
         ng-csv="formatLineCSV(slug, content)"
         field-separator=";"
         filename="<% slug %>.csv"
         csv-header="getLineCSVHeaders(slug, content)">
         <i class="fa fa-share-square-o"></i>
         <span translate>Export</span>
      </a>
    </div>
  </div>

  <div
    ng-if="content.data
    && geom.geometry.type === 'Polygon'
    && slug !== 'rain'"
    ng-repeat="(slug, content) in geom.properties"
    class="card active">

    <div class="card-content">

      <graph
        ng-if="content.aggType === 'curve'"
        line
        xlabel="'[%]'"
        ylabel="content.unit"
        data="content.data"
        keys="{x: 0, y: 1}">
      </graph>

      <graph
        ng-if="content.aggType === 'histogram'"
        bar-chart
        quantity="'linear'"
        ylabel="'[%]'"
        xlabel="content.unit"
        data="content.data"
        keys="{x: 0, y: 1}">
      </graph>

      <graph
        ng-if="content.aggType === 'counts'"
        horizontal-stack
        data="content.data"
        keys="{x: 'data', y: 'label'}"
        xlabel="'[%]'"
        dimensions="{height: 80, padding: {left: 0, right: 0, top: 5, bottom: 50 } }">
      </graph>

      <div ng-if="content.aggType !== 'histogram' && content.aggType !== 'curve' && content.aggType !== 'counts'">

        <graph
          ng-if="content.format === Store"
          line
          data="content.data">
        </graph>

      </div>

    </div>

  </div>
</div>
