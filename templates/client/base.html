{% load i18n %}
<!DOCTYPE html>
<html ng-app="lizard-nxt" ng-controller="MasterCtrl" ng-keydown="keyPress($event)" >
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Lizard</title><!-- {{ strap_orgs }} -->

    {% block css %}
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}distjs/css/vendor.css" />
    <link href='http://fonts.googleapis.com/css?family=Petit+Formal+Script|Kite+One|Roboto+Slab' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}distjs/css/nxt.css" />
    {% endblock css %}

    <script>
      var debug = true;

      var baseLayers = {{ strap_base_layers }};
      var layers = {{ strap_layers }};
      var data_bounds = {{ strap_data_bounds }};
      var event_types = {{ strap_event_types }};

      function logOut() {
        var r=confirm("Weet u zeker dat u wilt uitloggen?");
        if (r==true) {
          window.location = "{% url "login" %}?next=/";
          }
        else {
          return false;
        }
        }
    </script>
  </head>

  <body>

    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/"><span>Lizard</span></a>
        </div>

        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right" style="">

            {% if user.is_authenticated %}
              <li class="visible-xs">
                <a class="user" href="http://sso.lizard.net/edit_profile/" title="{% trans 'Edit profile' %}"><div class="" id="username"><i id="" class="fa fa-user"></i>&nbsp;&nbsp;{{ user.first_name }}</div></a>
              </li>            
              <li class="visible-sm visible-md visible-lg">
                <a class="user" href="http://sso.lizard.net/edit_profile/" title="{% trans 'Edit profile' %}">
                  <div class="" id="username">
                    <i id="" class="fa fa-user" style="font-size:1.2em;"></i>&nbsp;&nbsp;{{ user.first_name }}
                  </div>
                </a>
              </li>

              <li class="visible-xs">
                <a class="user logout" href="{% url "lizard_auth_client.sso_logout" %}?next=/" title="{% trans 'Logout' %}" onclick="return logOut()"><div class="" id="username"><i id="" class="fa fa-power-off"></i>&nbsp;&nbsp;Uitloggen</div></a>
              </li>
              <li class="visible-sm visible-md visible-lg" style="width:63px;">
                <a class="user logout" href="{% url "lizard_auth_client.sso_logout" %}?next=/" title="{% trans 'Logout' %}" onclick="return logOut()">
                  <div class="pull-right" id="username">
                    <i id="" style="font-size:1.2em;" class="fa fa-power-off"></i>
                  </div>
                </a>
              </li>
            {% else %}
              <li>
                <a href="{% url "login" %}?next=/" title="{% trans 'Login' %}">
                  <i class="fa fa-user pull-right"></i></a>
              </li>            
            {% endif %}

          </ul>
          {% block site_actions %}{% endblock site_actions %}
        </div><!--/.nav-collapse -->
      </div>
    </div>

    {% block svg_styles %}
    <div id="patterns" style="height:0;">
      <svg height="8" width="8" xmlns="http://www.w3.org/2000/svg" version="1.1">
        <defs>
          <pattern id="crosshatch" patternUnits="userSpaceOnUse" width="8" height="8">
            <image xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4JyBoZWlnaHQ9JzgnPgogIDxyZWN0IHdpZHRoPSc4JyBoZWlnaHQ9JzgnIGZpbGw9JyNmZmYnLz4KICA8cGF0aCBkPSdNMCAwTDggOFpNOCAwTDAgOFonIHN0cm9rZS13aWR0aD0nMC41JyBzdHJva2U9JyNhYWEnLz4KPC9zdmc+Cg==" x="0" y="0" width="8" height="8">
            </image>
          </pattern>
        </defs>
      </svg><svg height="5" width="5" xmlns="http://www.w3.org/2000/svg" version="1.1">
        <defs>
          <pattern id="lightstripe" patternUnits="userSpaceOnUse" width="5" height="5">
            <image xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc1JyBoZWlnaHQ9JzUnPgogIDxyZWN0IHdpZHRoPSc1JyBoZWlnaHQ9JzUnIGZpbGw9J3doaXRlJy8+CiAgPHBhdGggZD0nTTAgNUw1IDBaTTYgNEw0IDZaTS0xIDFMMSAtMVonIHN0cm9rZT0nIzg4OCcgc3Ryb2tlLXdpZHRoPScxJy8+Cjwvc3ZnPg==" x="0" y="0" width="5" height="5">
            </image>
          </pattern>
        </defs>
      </svg><svg height="5" width="5" xmlns="http://www.w3.org/2000/svg" version="1.1">
        <defs>
          <pattern id="smalldot" patternUnits="userSpaceOnUse" width="5" height="5">
            <image xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc1JyBoZWlnaHQ9JzUnPgo8cmVjdCB3aWR0aD0nNScgaGVpZ2h0PSc1JyBmaWxsPScjZmZmJy8+CjxyZWN0IHdpZHRoPScxJyBoZWlnaHQ9JzEnIGZpbGw9JyNjY2MnLz4KPC9zdmc+" x="0" y="0" width="5" height="5">
            </image>
          </pattern>
        </defs>
      </svg><svg height="49" width="6" xmlns="http://www.w3.org/2000/svg" version="1.1">
        <defs>
          <pattern id="verticalstripe" patternUnits="userSpaceOnUse" width="6" height="49">
            <image xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc2JyBoZWlnaHQ9JzQ5Jz4KICA8cmVjdCB3aWR0aD0nMycgaGVpZ2h0PSc1MCcgZmlsbD0nI2ZmZicvPgogIDxyZWN0IHg9JzMnIHdpZHRoPScxJyBoZWlnaHQ9JzUwJyBmaWxsPScjY2NjJy8+Cjwvc3ZnPgo=" x="0" y="0" width="6" height="49">
            </image>
          </pattern>
        </defs>
      </svg><svg height="6" width="6" xmlns="http://www.w3.org/2000/svg" version="1.1">
        <defs>
          <pattern id="whitecarbon" patternUnits="userSpaceOnUse" width="6" height="6">
            <image xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHhtbG5zOnhsaW5rPSdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJyB3aWR0aD0nNicgaGVpZ2h0PSc2Jz4KICA8cmVjdCB3aWR0aD0nNicgaGVpZ2h0PSc2JyBmaWxsPScjZWVlZWVlJy8+CiAgPGcgaWQ9J2MnPgogICAgPHJlY3Qgd2lkdGg9JzMnIGhlaWdodD0nMycgZmlsbD0nI2U2ZTZlNicvPgogICAgPHJlY3QgeT0nMScgd2lkdGg9JzMnIGhlaWdodD0nMicgZmlsbD0nI2Q4ZDhkOCcvPgogIDwvZz4KICA8dXNlIHhsaW5rOmhyZWY9JyNjJyB4PSczJyB5PSczJy8+Cjwvc3ZnPg==" x="0" y="0" width="6" height="6">
            </image>
          </pattern>
        </defs>
      </svg>
    </div>    
    {% endblock svg_styles %}

    {% block content %}
    
    <div id="text-mode-scrollable">
      
    </div>

    <div id="master">
      <div class="layer-menu-container">
        <div class="layer-switcher-wrapper pull-right" ng-class="{'slide-left': mapState.enabled}">
          <div class="layer-switcher slide-left">
            <ul class="nav">
              <li class="nav-header">
              <ul class="list-group">
                <li ng-repeat="layer in mapState.layers | orderBy:'order':true">
                <input id="<%layer.id%>-layer" class="hide" type="checkbox" ng-model="layer.active" ng-change="mapState.changeLayer(layer)">
                <label class="ng-class: {active: layer.active};" for="<% layer.id %>-layer" ng-bind="layer.name"></label>

                <div ng-switch="layer.follow_3di" style="float: right;">
                  <div ng-switch-when="undefined">
                    <i class="icon-screenshot pull-right zoomto-icon" ng-class="{visible: layer.active}" ng-click="zoomToTheMagic(layer)"></i>
                  </div>
                  <div ng-switch-when="true">
                    <i class="icon-eye-close pull-right zoomto-icon" ng-class="{visible: layer.active}" ng-click="setFollow(layer, false)"></i>
                  </div>
                  <div ng-switch-when="false">
                    <i class="icon-eye-open pull-right zoomto-icon" ng-class="{visible: layer.active}" ng-click="setFollow(layer, true)"></i>
                  </div>
                </div>
                </li>
                <!-- <li ng-click="toggleRain()" class="clickable"><label ng-class="{active: animation.enabled}">Regen</label> </li> -->
              </ul>
              </li>
              <!-- Temporary item to enable events -->
              <li id="events" class="nav-header">
              <ul class="list-group">
                <li ng-repeat="event in mapState.eventTypes">
                <label class="ng-class: {active: events.types[event.event_series].active};" ng-bind="event.type" ng-click="events.toggleEvents(event.event_series)"></label>
                <label class="count"  ng-if="events.types[event.event_series].active"><% events.types[event.event_series].currentCount %>&nbsp;(<% event.event_count %>) </label>
              </ul>
              </li>
              <li class="nav-header"> 
              <ul class="list-inline">
                <li class="baselayer-icon"
                    rel="tooltip" 
                    data-toggle="tooltip" 
                    data-placement="bottom" 
                    title="<% layer.name %>"
                    ng-click="mapState.changeBaselayer(layer)"
                    ng-repeat="layer in mapState.baselayers | orderBy:'order':true"
                    ng-class="{active: layer.active}"
                    id="<% layer.name %>">
                  <!-- <span ng-bind="layer.name"></span> -->
                  <i ng-if="layer.name == 'Topografie'" class="lizard-icon fa fa-road fa-2x"></i>
                  <i ng-if="layer.name == 'Satelliet'" class="lizard-icon icon-satellite"></i>
                  <i ng-if="layer.name == 'Hoogtekaart'" class="lizard-icon icon-terrain"></i>

                  <input id="<%layer.id%>-baselayer" 
                         class="hide" 
                         type="radio" 
                         ng-model="mapState.activeBaselayer" 
                         ng-value="layer.id" 
                         name="baselayer"> 
                  <label class="ng-class: {active: layer.active};" 
                         for="<% layer.id %>-baselayer"
                         ng-bind="layer.name">
                  </label>    
                </li>
              </ul>
              </li>              
            </ul>
          </div>
          <div id="ribbon" class="ribbon">
            <div class="arrow arrow-up" ng-click="mapState.enabled = !mapState.enabled" title="{% trans 'Map layers' %}">
            </div>
            <div class="arrow arrow-down" ng-click="mapState.enabled = !mapState.enabled" title="{% trans 'Map layers' %}"><i class="fa fa-compass ribbon-icon"></i>
            </div>
          </div>
          <div class="button-list-container" id="">
            <div class="button-list-item">
              <a href="#"
                 ng-click="toggleTool('profile')"
                 class="button-list-link"
                 title="{% trans 'Intersect tool' %}"
                 ng-class="{'active': tools.active === 'profile'}">
                 <i class="fa fa-expand"></i>
              </a>
            </div>
            <div class="button-list-item">
              <a href="#"
                 ng-click="box.type = 'elevation'"
                 class="button-list-link"
                 title="{% trans 'Elevation curve' %}"
                 ng-class="{'active': box.type === 'elevation'}">
                 <i class="fa fa-signal"></i>
              </a>
            </div>
            <div class="button-list-item">
              <a href="#"
                 ng-click="box.type = 'landuse'"
                 class="button-list-link"
                 title="{% trans 'Land use distribution' %}"
                 ng-class="{'active': box.type === 'landuse'}">
                 <i class="fa fa-circle-o"></i>
              </a>
            </div>
            <div class="button-list-item" ng-show="mapState.activeBaselayer === 3">
              <a href="#"
                 ng-click="toggleTool('autorescale')"
                 class="button-list-link"
                 title="{% trans 'Automatic rescaling on/off' %}"
                 ng-class="{'active': tools.active === 'autorescale'}">
                 <i class="fa fa-unsorted"></i>
              </a>
            </div>            
            <div class="button-list-item">
              <a href="#" 
                 ng-click="toggleTool('rain'); toggleRain();"
                 class="button-list-link" 
                 title="{% trans 'Rain on location' %}" 
                 ng-class="{'active': tools.active === 'rain'}">
                 <i class="fa fa-cloud"></i>
              </a>
            </div>
            <div class="button-list-item" ng-class="{'hide': mapState.activeBaselayer !== 1}">
              <a href="#"
                 ng-click="toggleTool('pipeSurface')"
                 class="button-list-link"
                 title="{% trans 'Highlight connected impervious surface' %}"
                 ng-class="{'active': tools.active === 'pipeSurface'}">
                 <i class="fa fa-code-fork"></i>
              </a>
            </div>            
          </div>
        </div>

        <map layers="mapState.layers"
             rasterprofile="disabled"
             vectorlayer
             click-layer="clickLayer"
             surfacelayer
             rain
             ng-class="{'crosshair': tools.active === 'profile'}">
         </map>
      </div>
    </div>

    {% block box_awesome %}{% endblock %}
    <dashboard id="dashboard" ng-show="box.detailMode"></dashboard>

    <div class="container" ng-controller="SearchCtrl">
      <omnibox id="omnibox"></omnibox>
    </div>
  </div> <!-- MapCtrl Closed.-->

{% block toolbar_controllers %}

    {% endblock toolbar_controllers %}
    {% endblock content %}



    {% block javascript_body %}
    <script type="text/javascript" src="{{ STATIC_URL }}distjs/js/ng.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}distjs/js/vendor.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}distjs/js/nxt.js?{{ random_string }}"></script>
    {% endblock %}

  <script>
    $(function () {
        $("[rel='tooltip']").tooltip();
    });
  </script>
  </body>
</html>
