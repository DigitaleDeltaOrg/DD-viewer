<div class="card" ng-controller="KpiCtrl" ng-animate=" 'animate' ">
  <div>
    <h2> <% kpi.cat_dict[kpi.slct_cat]  %> - <% kpi.slct_date %> </h2>
    <h4> <% kpi.slct_area %> </h4>
    <div>
      <dl class="dl-horizontal">
        <div class="btn-group btn-group-vertical">
          <div ng-repeat="category in kpi.categories">
            <dt>
              <button 
                type="button"
                ng-class="{'btn-primary': category == kpi.slct_cat}"
                ng-click="activate(kpi.slct_date, kpi.slct_area, category)"
                class="btn btn-mini btn-block">
                <% kpi.cat_dict[category]  %>
              </button>
            </dt>
            <dd>
              <!--ugly crap, make nicer data model for this -->
              <span class="badge" ng-class="{
                'badge-success': labelValue(kpi.slct_date, kpi.slct_area, category) >= kpi.thresholds.warning,
                'badge-warning': labelValue(kpi.slct_date, kpi.slct_area, category) <  kpi.thresholds.warning && labelValue(kpi.slct_date, kpi.slct_area, category) > kpi.thresholds.error,
                'badge-important': labelValue(kpi.slct_date, kpi.slct_area, category) <= kpi.thresholds.error && labelValue(kpi.slct_date, kpi.slct_area, category) > 0
                }">
                <% labelValue(kpi.slct_date, kpi.slct_area, category) %>
              </span>
            </dd>
          </div>
        </div>
      </dl>
    </div>
    <nxt-line-graph data="formatted_data" title="" ylabel="" xlabel="" ymin="0" ymax="10" type="kpi"></nxt-line-graph>
    <div>
      <button type="button" class="btn btn-small"
        ng-class="{'btn-primary': date == kpi.slct_date}"
        ng-repeat="date in kpi.dates"
        ng-click="activate(date, kpi.slct_area, kpi.slct_cat)"><%date%>
      </button>
    </div>
    <br />
    <div class="input-append">
      <select ng-model="kpi.slct_area" ng-options="area for area in kpi.areas"></select>
      <button class="btn"
        ng-class="{'btn-primary': area_level == 'wijk'}"
        ng-click="kpiFormatter('wijk')">wijk</button>
      <button class="btn"
        ng-class="{'btn-primary': area_level == 'gemeente'}"
        ng-click="kpiFormatter('gemeente')">gemeente</button>
    </div>
    <div class="btn-group" ng-model="area_level">
    </div>
  </div>

  <div>
    <label class="checkbox">
      <input type="checkbox" ng-model="checked" ng-init="checked=false" /> Instellen grenzen
    </label>
    <div ng-show="checked" id="threshold" class="well">
      <label for="low">Bovengrens: </label>
      <input type='range' ng-model='kpi.thresholds.warning' min='1' max='10'>

      <label for="high">Ondergrens: </label>
      <input type='range' ng-model='kpi.thresholds.error' min='1' max='10'>

    </div>
  </div>

</div>

